<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagina de Incrição Desafio</title>
    <link rel="stylesheet" type="text/css" href="stylep.css"><!-- link de ligação css com html-->
    <link rel="file" type="html" href="index.html"
</head>

<body>
  <header class="cabecalho"> <!--Inicio do codigo cabeça/menu-->
    <img class="cabecalho-logo" src="Titulo%20DesaafioEvolutivo.png" alt="Desafio Evolutivo" ><!-- Logo da pagina onde o link deve levar para homepage-->
    <nav class="cabecalho-menu">
      <a class="cabecalho-menu-item" href="Menu Inicial.HTML">Meus Desafios</a> <!--linkar cada item-->
      <a class="cabecalho-menu-item">Novos Desafios</a>
      <a class="cabecalho-menu-item">Histórico de Desafios</a>
      <a class="cabecalho-menu-item">Contatos</a>
    </nav>
    <div class="cabecalho-icones"> <!--Div criada somente para que os dois icones possam ficar proximos.-->
      <img class="cabecalho-sino" src="sino.png" alt="Denho Sino Notificação"><!--Sino das notificações onde o link deverá levar para pag. de avisos.-->
      <img class="cabecalho-avatar" src="avatar.png" alt="Avatar"><!--Avatar do perfil onde o link devera levar para o perfil, possibilitando mudanças no cadastro-->
    </div>
  </header>
    <main class="conteudo"><!--Inicio do codigo meio/corpo, onde encontra toda a parte central, dividida em sessões.-->
      <section class="conteudo-titulo">
        <h1 class="conteudo-titulo-h1"> Meu perfil </h1>
        <p class="conteudo-titulo-paragrafo">Aqui você pode fazer alterações nos seus dados</p>
      </section>
      <section class="conteudo-principal">
        <div class="conteudo-principal-dados">
          <form action="" id="dados-form"> <!--Campos estilo formulário com dados do usuário para editar-->
            <div class="form>"
              <label1 for="conteudo-principal-dados-nome"> Nome: </labe1>
              <input type="text" name="nome" id="conteudo-principal-dados-nome" >
              <button class="conteudo-principal-dados-nome-botao" onclick="editarcampo()">Editar </button>
            </div>

            <div class="form>"
              <label2 for="conteudo-principal-dados-email"> E-mail: </label2>
              <input type="email" name="email" id="conteudo-principal-dados-email" required>
              <button class="conteudo-principal-dados-email-botao"onclick="editarcampo()">Editar </button>
            </div>

            <div class="form>"
              <label3 for="conteudo-principal-dados-email"> Senha: </label3>
              <input type="password" name="senha" id="conteudo-principal-dados-senha" required>
              <button class="conteudo-principal-dados-senha-botao"onclick="editarcampo()">Editar </button>
            </div>
          </form>
        </div>
      <div class="conteudo-principal-perfil">
       <img id="conteudo-principal-perfil-anon" src="Avatar_icon_green.png" >
       <input type="file" id="foto-input" class="foto-input" accept="image/*" style="display:none;">
       <div class="conteudo-principal-perfil-botao">
        <p>Escolha uma foto quadrada</p>
        <button id= "botao-imagem" onclick="mostrarFotodePerfil()">Enviar Imagem</button>
       </div>
      </div>

    </section>
    </main>
 <footer></footer><!--Espaço reservado para nosso rodapé--> 
 
 <script>

function importarValor() {
 if (localStorage.getItem(email) && localStorage.getItem(senha)) {
      document.getElementById('conteudo-principal-dados-email').value = localStorage.getItem('cadastro-email');
      document.getElementById('conteudo-principal-dados-senha').value = localStorage.getItem('cadastro-password');
      return;
    } else {
      window.location.href = 'index.html';
  }
}
window.onload = function() {
importarDadosLocalStorage();
};
  

function editarCampo() { //função para editar dados, em breve
    // Pega os dados do email e senha
    const email = document.getElementById("cadastro-email").value;
    const senha = document.getElementById("cadastro-password").value;

    // Verificar se a senha tem pelo menos 6 caracteres, incluindo pelo menos uma letra minúscula, uma letra maiúscula e um caractere especial
    const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{6,}$/;
    if (!regex.test(senha)) {
      alert("A senha deve ter no mínimo 6 caracteres, incluindo pelo menos uma letra minúscula, uma letra maiúscula e um caractere especial.");
      return;
    }
    // Armazenar e-mail e senha em chaves separadas no localStorage
    localStorage.setItem(email, senha);
      alert("Dados salvos com sucesso!");
  } 


function mostrarFotodePerfil() { //função para inserir imagem de perfil

  const input = document.getElementById('foto-input');
  const output = document.getElementById('conteudo-principal-perfil-anon');

  input.onchange = function (e) {
        const file = e.target.files[0];
        const reader = new FileReader();

  reader.onload = function(event) { 
    output.src = event.target.result; 
    //output.style.display='block';
    output.style.width = '250px'; //configurando o a imagem escolhida, o input é apenas o lugar
    output.style.height = '250px';
   
  localStorage.setItem('profilepic', event.target.result);
  const fotosalva = localStorage.getItem('profilepic');
  const avatar = document.querySelector('.cabecalho-avatar');        
  avatar.src = fotosalva;

  }

  reader.readAsDataURL(file);
 };

 input.click();
}

window.onload = () => {
    const fotosalva = localStorage.getItem('profilepic');

    if (fotosalva) {
      const avatar = document.querySelector('.cabecalho-avatar');        
      avatar.src = fotosalva;
      const perfil = document.querySelector('#conteudo-principal-perfil-anon');
      perfil.src = fotosalva;
      document.getElementById('botao-imagem').innerText = 'Trocar imagem';
      //document.getElementById('botao-imagem').value= "Trocar imagem";
      //const botao = document.querySelector('#botao-imagem');
      //botao.textcontent = "Trocar imagem";
    }
};

</script>
</body>
</html>
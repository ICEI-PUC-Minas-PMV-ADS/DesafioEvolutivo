<!DOCTYPE html>
<html lang="en">
<head>
    <!--ATENÇÃO: A DATA UTILIZADA ESTÁ SENDO A AMERICANA. ACHAR UM JEITODE USAR A BR, PQ A NOITE PODE AVANÇAR UM DIA-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafio Diário</title>
</head>
<body>
    <h1>Desafio Diário</h1>
    <p id="contador">Desafios completados: 0</p> <!--Aqui o Giuseppe pode adaptar o "0/30" ao invés da porcentagem-->
    
    <button id="desafioBtn">Desafio Feito</button> <!-- Podemos usar um botão apenas de "desafio feito!" na parte
    do gustavo onde a pessoa clica assim que fizer o desafio-->

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            // Recupera o contador e a data do último desafio do localStorage
            let contador = parseInt(localStorage.getItem('contador')) || 0; //alterar esse número para forçar teste
            let lastChallengeDate = localStorage.getItem('lastChallengeDate') || '';
            let chancedevacilo = parseInt(localStorage.getItem('chancedevacilo')) || 1;
            localStorage.setItem('chancedevacilo', chancedevacilo);
            
            // Exibe o contador atual na página
            document.getElementById('contador').textContent = `Desafios completados: ${contador}`;

            // Atualiza o contador se o botão for clicado
            document.getElementById('desafioBtn').addEventListener('click', () => {
                const today = new Date().toISOString().split('T')[0]; // Formato YYYY-MM-DD               
                
                // Verifica se o desafio já foi feito hoje
                if (today !== lastChallengeDate && contador < 30) {
                    contador = Math.min(contador + 1); // Incrementa o contador
                    lastChallengeDate = today;

                    // Atualiza o contador e a data do último desafio no localStorage
                    localStorage.setItem('contador', contador);
                    localStorage.setItem('lastChallengeDate', lastChallengeDate);

                    // Atualiza o contador na página
                    document.getElementById('contador').textContent = `Desafios completados: ${contador}`;
                    
                    // Vitória no desafio
                    if (contador >= 30) {
                        alert('Parabéns! Você venceu o desafio!');
                    } 
                }
                else {
                    alert('Você já completou o desafio de hoje!');
                }

                //A pessoa pulou um dia e perdeu o desafio
                //if (today !== lastChallengeDate && yesterday !== lastChallengeDate && chancedevacilo == 1) {
                //    alert('Que vacilo! Você falhou no desafio. Mas não se preocupe, você terá uma chance!');
                //    contador = Math.min(contador + 1);
                //   chancedevacilo = chancedevacilo - 1;
                //    lastChallengeDate = today;
                //}
                //else if (today !== lastChallengeDate && yesterday !== lastChallengeDate && chancedevacilo == 0) {
                //   alert('Volte ao início do desafio! Tente novamente, você irá conseguir!');
                //    contador = 0;
                //}
            });
        });
    </script>
</body>
</html>
